# Разработка

В этом разделе описаны рекомендации и инструменты для разработки проекта PPVijetBankCard.

## Структура проекта

```
PPVijetBankCard/
├── src/
│   ├── __init__.py
│   ├── masks.py          # Базовые функции маскировки
│   ├── widget.py         # Расширенные функции
│   └── processing.py     # Функции обработки данных
├── generators/
│   ├── __init__.py       # Экспорт функций генераторов
│   └── generators.py     # Генераторы для обработки данных
├── tests/
│   ├── __init__.py
│   ├── conftest.py       # Общие фикстуры для тестов
│   ├── test_masks.py     # Базовые тесты функций маскировки
│   ├── test_masks_fixtures.py  # Параметризованные тесты маскировки
│   ├── test_processing.py # Тесты функций обработки
│   ├── test_processing_fixtures.py  # Параметризованные тесты обработки
│   ├── test_widget.py    # Тесты форматирования данных
│   ├── test_widget_fixtures.py  # Параметризованные тесты форматирования
│   ├── test_generators.py     # Тесты функций-генераторов
│   └── test_generators_fixtures.py  # Параметризованные тесты генераторов
├── htmlcov/              # Отчет о покрытии кода тестами
├── main.py               # Демонстрация всех функций
├── requirements.txt      # Зависимости
├── pyproject.toml        # Конфигурация проекта
└── README.md             # Документация
```

## Описание модулей

| Файл | Описание |
|------|----------|
| `src/masks.py` | Базовые функции маскировки карт и счетов |
| `src/widget.py` | Умные функции для работы со строками и датами |
| `src/processing.py` | Функции для обработки и фильтрации транзакций |
| `generators/generators.py` | Генераторы для обработки данных транзакций и генерации номеров карт |
| `tests/conftest.py` | Общие фикстуры для тестов |
| `tests/test_masks.py` | Базовые тесты функций маскировки |
| `tests/test_masks_fixtures.py` | Параметризованные тесты функций маскировки |
| `tests/test_processing.py` | Тесты функций обработки транзакций |
| `tests/test_processing_fixtures.py` | Параметризованные тесты функций обработки |
| `tests/test_widget.py` | Тесты форматирования данных и дат |
| `tests/test_widget_fixtures.py` | Параметризованные тесты форматирования |
| `tests/test_generators.py` | Тесты функций-генераторов |
| `tests/test_generators_fixtures.py` | Параметризованные тесты функций-генераторов |
| `main.py` | Демонстрационная программа |

## Инструменты качества кода

Проект использует современные инструменты для обеспечения качества:

- **Black** - автоматическое форматирование кода
- **Flake8** - проверка стиля и ошибок
- **isort** - сортировка импортов
- **mypy** - статическая проверка типов

### Команды для разработки

```bash
# Форматирование кода
black .

# Проверка стиля
flake8 .

# Сортировка импортов
isort .

# Проверка типов
mypy .
```

## Рекомендации по разработке

### Стиль кода

1. **Следуйте PEP 8** - используйте стандарт оформления кода Python
2. **Используйте Black** - для автоматического форматирования кода
3. **Пишите понятные имена** - переменных, функций и классов
4. **Добавляйте docstrings** - ко всем публичным функциям и классам

### Типизация

1. **Используйте аннотации типов** - для всех параметров и возвращаемых значений
2. **Проверяйте типы с mypy** - перед отправкой кода
3. **Используйте Union** - для функций, принимающих несколько типов

### Тестирование

1. **Пишите тесты** - для всех новых функций
2. **Используйте фикстуры** - для параметризованных тестов
3. **Проверяйте覆盖率** - стремитесь к 100% покрытию кода тестами

### Документация

1. **Обновляйте README.md** - при добавлении новой функциональности
2. **Пишите docstrings** - в формате Google или NumPy
3. **Создавайте примеры** - использования функций

## Процесс внесения изменений

1. **Создайте ветку** для новой функциональности
2. **Напишите код** с соблюдением рекомендаций
3. **Напишите тесты** для новой функциональности
4. **Проверьте стиль** кода с помощью инструментов
5. **Проверьте типы** с помощью mypy
6. **Запустите тесты** и убедитесь, что они проходят
7. **Проверьте покрытие** кода тестами
8. **Обновите документацию** при необходимости
9. **Создайте pull request** с описанием изменений

## Тестирование

Проект имеет комплексный набор тестов для проверки корректности работы всех функций:

```bash
# Запуск всех тестов
pytest

# Запуск тестов с выводом покрытия
pytest --cov=src

# Запуск конкретного тестового файла
pytest tests/test_masks.py

# Запуск тестов с генерацией HTML-отчета о покрытии
coverage run -m pytest
coverage html
```

### Структура тестов

- `tests/test_masks.py` - базовые тесты функций маскировки карт и счетов
- `tests/test_masks_fixtures.py` - параметризованные тесты функций маскировки с использованием фикстур
- `tests/test_processing.py` - тесты функций обработки транзакций
- `tests/test_processing_fixtures.py` - параметризованные тесты функций обработки с использованием фикстур
- `tests/test_widget.py` - тесты форматирования данных и дат
- `tests/test_widget_fixtures.py` - параметризованные тесты форматирования с использованием фикстур
- `tests/conftest.py` - общие фикстуры для тестов

### Покрытие кода

После запуска тестов с покрытием вы можете найти подробный HTML-отчет в папке `htmlcov`. Откройте файл `htmlcov/index.html` в браузере для просмотра детальной информации о покрытии кода тестами.

Для генерации отчета о покрытии:
```bash
# Запуск тестов с покрытием
coverage run -m pytest

# Генерация HTML-отчета
coverage html

# Просмотр отчета
open htmlcov/index.html
```

Текущее покрытие тестами:
- `src/masks.py`: 100%
- `src/processing.py`: 100%
- `src/widget.py`: 100%

## Участие в проекте

Мы приветствуем вклад в проект! Если вы хотите внести изменения, пожалуйста:

1. Ознакомьтесь с кодом проекта и его структурой
2. Изучите существующие тесты и их структуру
3. Создайте issue с описанием предлагаемых изменений
4. Создайте pull request с вашими изменениями
5. Убедитесь, что все тесты проходят и покрытие кода не снижается

## Часто задаваемые вопросы

### Как добавить новую функцию маскировки?

1. Добавьте функцию в соответствующий модуль (`masks.py` или `widget.py`)
2. Напишите тесты в соответствующий тестовый файл
3. Обновите документацию
4. Проверьте стиль кода и типы

### Как добавить новый генератор?

1. Добавьте функцию-генератор в `generators/generators.py`
2. Напишите тесты в `tests/test_generators.py`
3. Добавьте пример использования в документацию

### Как обновить зависимости?

1. Измените `requirements.txt` или `pyproject.toml`
2. Протестируйте с новыми версиями зависимостей
3. Обновите документацию при необходимости
